{
  "hash": "af13837926ee4423a3cb2117eb49a7a6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Sample Census Analysis\"\nsubtitle: \"Demonstrating tidycensus and spatial analysis\"\ndate: today\nauthor: \"Dr. Elizabeth Delmelle\"\nformat:\n  html:\n    code-fold: true\n    toc: true\n---\n\n\n\n## Introduction\n\nThis is simply some sample analysis showing students how to document their work professionally.\n\n**This is not a real assignment for this course!**\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidycensus)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(leaflet)\nlibrary(tigris)\ncensus_api_key(\"42bf8a20a3df1def380f330cf7edad0dd5842ce6\")\n```\n:::\n\n\n\n\nLet's example how median income varies across the city of Philadelphia\n\n\n\n::: {.cell progress='false'}\n\n```{.r .cell-code}\n# Get Philadelphia County data\nphilly_income <- get_acs(\n  geography = \"tract\",\n  variables = \"B19013_001\", # Median household income\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE,\n  year = 2022,\n  progress = FALSE \n)\n\n# Clean the data\nphilly_income <- philly_income |>\n  filter(!is.na(estimate)) |>\n  mutate(income_k = estimate / 1000) # Convert to thousands for easier reading\n```\n:::\n\n\n\n## Exploratory Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Basic summary\nsummary(philly_income$estimate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  14983   39596   58514   63883   82809  181066 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Histogram\nggplot(philly_income, aes(x = income_k)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", alpha = 0.7) +\n  labs(\n    title = \"Distribution of Median Household Income\",\n    subtitle = \"Philadelphia Census Tracts, 2022 ACS\",\n    x = \"Median Household Income (thousands)\",\n    y = \"Number of Census Tracts\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Distribution of median household income in Philadelphia](sample-census-analysis_files/figure-html/explore-1.png){width=672}\n:::\n:::\n\n\n## Spatial Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create income classes\nphilly_income <- philly_income |>\n  mutate(\n    income_class = case_when(\n      income_k < 25 ~ \"Under $25k\",\n      income_k >= 25 & income_k < 50 ~ \"$25k - $50k\", \n      income_k >= 50 & income_k < 75 ~ \"$50k - $75k\",\n      income_k >= 75 & income_k < 100 ~ \"$75k - $100k\",\n      income_k >= 100 ~ \"$100k+\"\n    ),\n    # Convert to factor to control order\n    income_class = factor(income_class, \n                         levels = c(\"Under $25k\", \"$25k - $50k\", \"$50k - $75k\", \n                                   \"$75k - $100k\", \"$100k+\"))\n  )\n\n# Create choropleth map with classes\nggplot <- ggplot(philly_income) +\n  geom_sf(aes(fill = income_class), color = \"white\", size = 0.1) +\n  scale_fill_brewer(type = \"seq\", palette = \"YlOrRd\", name = \"Median\\nIncome\") +\n  labs(\n    title = \"Median Household Income by Census Tract\",\n    subtitle = \"Philadelphia, 2022 ACS 5-Year Estimates\",\n    caption = \"Source: U.S. Census Bureau\"\n  ) +\n  theme_void() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 12, hjust = 0.5),\n    legend.position = \"bottom\"\n  )\n\n# Get water features for Philadelphia\nphilly_water <- area_water(state = \"PA\", county = \"Philadelphia\", \n                          year = 2022, progress = FALSE)\n# Add to your map\nggplot() +\n  # Water first (background)\n  geom_sf(data = philly_water, fill = \"lightblue\", color = \"lightblue\", alpha = 0.7) +\n  # Then census tracts on top\n  geom_sf(data = philly_income, aes(fill = income_class), color = \"white\", size = 0.1) +\n  scale_fill_brewer(type = \"seq\", palette = \"YlOrRd\", name = \"Median\\nIncome\") +\n  labs(\n    title = \"Median Household Income by Census Tract\",\n    subtitle = \"Philadelphia, 2022 ACS 5-Year Estimates\",\n    caption = \"Source: U.S. Census Bureau\"\n  ) +\n  theme_void() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 12, hjust = 0.5),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![Spatial distribution of income across Philadelphia](sample-census-analysis_files/figure-html/map-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}